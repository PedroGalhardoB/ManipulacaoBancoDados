<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pedro Galhardo">

<title>Desafio_08</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Desafio8_files/libs/clipboard/clipboard.min.js"></script>
<script src="Desafio8_files/libs/quarto-html/quarto.js"></script>
<script src="Desafio8_files/libs/quarto-html/popper.min.js"></script>
<script src="Desafio8_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Desafio8_files/libs/quarto-html/anchor.min.js"></script>
<link href="Desafio8_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Desafio8_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Desafio8_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Desafio8_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Desafio8_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Desafio_08</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pedro Galhardo </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="desafio-8" class="level1">
<h1>DESAFIO 8</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#importando o pacote que será utilizado</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="item-1" class="level2">
<h2 class="anchored" data-anchor-id="item-1">ITEM 1:</h2>
<p>Baixe o arquivo uwmadison.sqlite3. Conecte-se a ele usando o pacote RSQLite, armazenando a conexão em uma variável conn.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Descompactando o arquivo zip</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(<span class="st">"../dados/database.sqlite3.zip"</span>, <span class="at">exdir =</span> <span class="st">"../dados"</span>) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Conectando ao banco de dados SQLite</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>conn <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">SQLite</span>(), <span class="st">"../dados/database.sqlite3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Verificando se a conexão deu certo listando as tabelas disponíveis:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListTables</span>(conn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "course_offerings"    "courses"             "grade_distributions"
 [4] "instructors"         "rooms"               "schedules"          
 [7] "sections"            "subject_memberships" "subjects"           
[10] "teachings"          </code></pre>
</div>
</div>
</section>
<section id="item-2" class="level2">
<h2 class="anchored" data-anchor-id="item-2">ITEM 2:</h2>
<p>Quem são e quantos são os professores que lecionaram disciplinas cujo tópico era estatística (subjects.abbreviation=‘STAT’)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mostra os valores contidos dentro dessas tabelas para podermos montar nosso código</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListFields</span>(conn, <span class="st">"courses"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "uuid"   "name"   "number"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListFields</span>(conn, <span class="st">"subjects"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "code"         "name"         "abbreviation"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista os nomes dos professores que lecionaram disciplinas STAT</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>professores_stat <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="st">"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT i.name</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM instructors i</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN teachings t ON i.id = t.instructor_id</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN sections s ON t.section_uuid = s.uuid</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN course_offerings co ON s.course_offering_uuid = co.uuid</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN subjects sub ON sm.subject_code = sub.code</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE sub.abbreviation = 'STAT'</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY i.name</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostra os primeiros nomes encontrados</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>professores_stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             name
1                 ABIGAIL BENZINE
2            ADIN-CRISTIAN ANDREI
3                  AKICHIKA OZEKI
4                      ALAN HUANG
5                 ALBERTO DEL PIA
6                  ALBRECHT KLEMM
7             ALEXANDER COVINGTON
8                  ALEXANDER FISH
9               ALEXANDER KISELEV
10                 ALYSSA DIGILIO
11                   ANATOLE BECK
12                  ANDREJ ZLATOS
13                  ANDREW LESLIE
14                  ANNE BRUCKNER
15                       ANQI SHI
16                     ANRU ZHANG
17                  ARNOLD MILLER
18                  AUGUST JENSEN
19                 BEHZAD AALIPUR
20      BEHZAD AALIPUR HAFSHEJANI
21               BEN ADAM HAALAND
22                  BENEDEK VALKO
23                 BENJAMIN RECHT
24                    BI CHENG WU
25                        BIN DAI
26                      BIN ZHANG
27                        BIN ZHU
28                   BINGYING XIE
29                       BO HUANG
30                        BO YANG
31                       BOWEN HU
32                    BRET HANLON
33                    BRET LARGET
34                  BRIAN YANDELL
35                    BROOK LUERS
36                     CECILE ANE
37                      CHAN PARK
38                    CHANHAN HSU
39                    CHAOQUN MEI
40                    CHAOYANG YU
41                  CHELSEY GREEN
42                     CHEN CHENG
43                      CHEN JING
44                CHENGNING ZHANG
45                   CHENLIANG XU
46                CHENSHENG KUANG
47                      CHENXI LI
48                 CHIA-CHIEH LIN
49                 CHIEN-WEI CHEN
50       CHRISTINA M. KENDZIORSKI
51             CHRISTINE SORKNESS
52             CHRISTOPHER WAGNER
53                   CLAIRE BOBST
54            CLAUDIA SOLIS LEMUS
55                      COLE COOK
56                COLIN LONGHURST
57                   CRYSTAL CHEN
58                      CUICUI QI
59                      CUIZE HAN
60            DANIELE CAPPELLETTI
61                 DAVID ANDERSON
62                   DAVID DEMETS
63                DAVID GRIFFEATH
64                     DEBRAJ DAS
65                     DEREK BEAN
66                   DEREK NORTON
67                   DEYUAN JIANG
68            DIETRICH UHLENBROCK
69                  DONALD PORTER
70                       DONG XIA
71                    DONGGYU KIM
72                   DONGHYUN LEE
73               DOUGLAS M. BATES
74                     DUY NGUYEN
75                     DUZHE WANG
76                   EDWARD ERKER
77                ELOISA D CHAVAS
78              ERICA LEE DEADMAN
79                  ERIK NORDHEIM
80                        FAN GAO
81                       FAN YANG
82                      FANG FANG
83                  FANGFANG WANG
84               FLORIAN BERTRAND
85                FREDERICK BOEHM
86               GARVESH RASKUTTI
87          GARY HOWARD SCHROEDER
88                        GENG LI
89                 GINA BENNINGER
90                        GINA OH
91               GONZALO CONTADOR
92                    GRACE WAHBA
93         GREGORIO MORENO-FLORES
94               GREGORY SHINAULT
95                   GUANHUA CHEN
96                    GUANNAN SUN
97                 GUILHERME ROSA
98  GUILHERME VIEIRA NUNES LUDWIG
99                 GUN WOONG PARK
100                      HAN CHEN
101                      HAO CHEN
102                      HAO TENG
103                     HAO ZHENG
104                      HAO ZHOU
105                      HAODA FU
106                   HAOYANG FAN
107         HEATHER MARIE BRAZEAU
108                  HUAIBAO FENG
109                      HUI WANG
110                  HUIKUN ZHANG
111                     HUILIN HU
112                   HYEBIN SONG
113                HYUNSEUNG KANG
114            IAN BRANSTAD RILEY
115                 ISMOR FISCHER
116                JAMES ANDERSON
117                JAMES D KUELBS
118                   JARED BROWN
119                  JASON P FINE
120         JASON RICHARD SWANSON
121                  JEE YEON KIM
122                     JEEA CHOI
123             JENNIFER BIRSTLER
124               JENNIFER NGUYEN
125           JESSE THOMAS HOLZER
126                   JIAJIE CHEN
127                      JIALE XU
128                       JIAN WU
129                  JIANCHANG HU
130                      JIE SONG
131                       JIE WEI
132                     JIE ZHANG
133                     JILI WANG
134                   JINGCI MENG
135                JINGJIANG PENG
136                    JINGLAN LI
137                    JIWEI ZHAO
138                    JOHN DAVIS
139                  JOHN GILLETT
140                     JOHN KANE
141         JOHN WILTSHIRE-GORDON
142             JONATHON PETERSON
143                 JOSEP GINEBRA
144                JOSEPH DEUTSCH
145                    JU HEE CHO
146                        JUN LI
147                      JUN SHAO
148                       JUN YIN
149                     JUN ZHANG
150                       JUN ZHU
151                   JUNGWON MUN
152                    JUNHEE HAN
153                     JUNHO LEE
154                   KAILEI CHEN
155                  KAM-WAH TSUI
156                   KARL BROMAN
157                     KARL ROHE
158               KATHERINE GOODE
159               KAZUHIKO SHINKI
160              KEEGAN KORTHAUER
161                       KEN ONO
162            KEVIN HASEGAWA ENG
163                 KEVIN PACKARD
164                  KJELL DOKSUM
165  KRISHNAKUMAR BALASUBRAMANIAN
166                KRISTEN CYFFKA
167                 KUNLING HUANG
168                   KYLE HEBERT
169                   KYLE HERBET
170                 KYUNGMANN KIM
171                        LAM HO
172                       LAN LUO
173                LANCINE KONATE
174                        LEI XU
175                   LEV BORISOV
176                 LIAM JOHNSTON
177                     LIE XIONG
178                      LILI LAN
179                    LILI ZHENG
180                      LILUN DU
181                        LIN QI
182                     LONG PHAN
183                        LU MAO
184                       LU YANG
185                   LUWAN ZHANG
186                      LUXI CAO
187            MANJUSHA KANCHARLA
188                    MARI PALTA
189              MARIA KAMENETSKY
190                    MARIA ROJO
191               MARIAN R FISHER
192                MARY LINDSTROM
193               MATTHEW BALLARD
194                     MENG SONG
195                MICHAEL FERRIS
196          MICHAEL GEORGE ILTIS
197                 MICHAEL HOGAN
198               MICHAEL KUTZLER
199                  MICHAEL LIOU
200                MICHAEL NEWTON
201          MICHAEL RENE KOSOROK
202               MICHELLE HARRIS
203                 MIHAELA IFRIM
204                  MIN JUNG LEE
205                       MIN NIU
206                      MING XIE
207                     MING YUAN
208                   MINJING TAO
209              MITCHELL PAUKNER
210                   MOO K CHUNG
211                    MUHONG GAO
212                MURRAY CLAYTON
213         NATALIA DE LEON GATTI
214               NELLIE LAUGHLIN
215            NICHOLAS HENDERSON
216       NICHOLAS STEPHEN KEULER
217                      NING FAN
218            NORBERT BINKIEWICZ
219                 NORMAN DRAPER
220            PAUL M TERWILLIGER
221                  PAUL RATHOUZ
222              PAUL SAVARIAPPAN
223                   PEIGEN ZHOU
224                   PERLA REYES
225                   PHILIP WOOD
226                      QI JIANG
227                       QI TANG
228                 QIAN ZHIGUANG
229                       QING LI
230                   QIONG ZHANG
231                   QIURONG CUI
232                    QUEFENG LI
233                     QUOC TRAN
234                REBECCA KOSCIK
235                  REBECCA POST
236             RICHARD A BRUALDI
237            RICHARD A. JOHNSON
238           RICHARD J. CHAPPELL
239                 ROBERT HARRON
240                ROBERT R MEYER
241                ROBERT WARDROP
242            ROBERT WAYNE GREEN
243                RONALD GANGNON
244                   RONGJUN ZHU
245                      RUI CHEN
246                      RUI TANG
247                  RUIFANG SONG
248                    RUIFENG XU
249                   RUNGANG HAN
250                     RUOSI GUO
251                      RYAN ZEA
252              SAMUEL STECHMANN
253                  SANGBUM CHOI
254                 SCOTT HOTTOVY
255           SCOTT JOSEPH HETZEL
256                     SEAN KENT
257                SEBASTIEN ROCH
258                     SEHO PARK
259                   SEULKEE YUN
260                 SEUNGBONG HAN
261                       SHAN LU
262                  SHANE HUBLER
263                      SHANG WU
264                    SHENG WANG
265                   SHENG ZHANG
266                   SHENGJI JIA
267                       SHI JIN
268                    SHIXUE LIU
269                  SHIZHEN WANG
270                    SHUAI CHEN
271                  SHUANG HUANG
272                   SHULEI WANG
273                     SHUYUN YE
274                   SIJIAN WANG
275                     SIJING LI
276                SOHEIL SADEGHI
277                    SOKOL VAKO
278                SONA Z SWANSON
279                     SONG WANG
280  SRIKANTHMADHAVAN ARAVAMUTHAN
281                 STEFFEN LEMPP
282        STEPHEN AARON STANHOPE
283                  STEPHEN BERG
284               STEPHEN WAINGER
285                STEPHEN WRIGHT
286                    STEVEN SAM
287             SUKHENDU MEHROTRA
288                  SUNDUZ KELES
289                     TAERI UHM
290                        TAO YU
291       THEVAASIINEN CHANDERENG
292                   THOMAS COOK
293               THOMAS G. KURTZ
294                        THU LE
295                       TIEN VO
296              TIMO SEPPALAINEN
297                 TIMOTHY IDOWU
298                       TING YE
299                   TING-LI LIN
300                       TONG LI
301                  TONGHAI YANG
302                       TRAM TA
303                    TUN LEE NG
304               TZU HSIANG HUNG
305               VARSHA KULKARNI
306                    VICTOR LUO
307            VICTORIA MANSFIELD
308                  WAI TONG FAN
309                     WEI ZHENG
310                   WEI-YIN LOH
311                  WENWEN ZHANG
312                    WENZHI CAO
313                  WESLEY CHANG
314                      XIAO GUO
315                      XIAO NIE
316                   XIAODAN WEI
317                    XIAOMAO LI
318                 XIAOPING FENG
319                    XIAOWU DAI
320                        XIN LI
321                     XIN ZHANG
322                     XINJIE HE
323                   XINWEI DENG
324                     XINXIN YU
325                    XINYU SONG
326                    XIPEI YANG
327                    XIRAN WANG
328                  XIUFENG SHAO
329                      XIUYU MA
330                      XIWEN MA
331                         XU HE
332                         XU XU
333                   XUEYAO CHEN
334                      XUN ZHAO
335                     YAJUAN SI
336                     YALI WANG
337                      YAN CHEN
338                 YANBING ZHENG
339                     YANG ZHAO
340                    YANNAN QIU
341                    YAOGUO XIE
342                     YAOYAO XU
343                   YAZHEN WANG
344                       YI CHAI
345                         YI LI
346                        YI LIU
347                     YIFAN MEI
348                   YILIN ZHANG
349                    YING ZHANG
350                   YONGFENG WU
351                  YONGJOON KIM
352                    YONGSU LEE
353                     YOUNG LEE
354                YOUNG MIN PARK
355               YOUNGDEOK HWANG
356                     YOURAN QI
357                   YU MENGGANG
358                    YU QIU LIU
359                    YUAN JIANG
360                       YUAN LI
361                     YUAN WANG
362                    YUANZHI LI
363                    YUCHANG WU
364                   YUCHEN ZHOU
365                   YUJIN CHUNG
366                    YUNONG LIN
367                     YUQING XU
368                ZHANG CHUNMING
369                ZHENGJUN ZHANG
370                  ZHENGXIAO WU
371                  ZHIGENG GENG
372                   ZHIGUO XIAO
373                   ZHONGJIE YU
374                     ZHUANG WU
375                   ZIFENG ZHAO
376                     ZIJIAN NI
377                 ZUOFENG SHANG</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conta quantos professores distintos existem</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>quantidade_professores <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="st">"</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT COUNT(DISTINCT i.name) AS qtd_professores</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM instructors i</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN teachings t ON i.id = t.instructor_id</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN sections s ON t.section_uuid = s.uuid</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN course_offerings co ON s.course_offering_uuid = co.uuid</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN subjects sub ON sm.subject_code = sub.code</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE sub.abbreviation = 'STAT'</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>quantidade_professores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  qtd_professores
1             377</code></pre>
</div>
</div>
</section>
<section id="item-3" class="level2">
<h2 class="anchored" data-anchor-id="item-3">ITEM 3:</h2>
<p>O GPA americano é definido numa escala de 0 a 4, em que A = 4, AB = 3.5, B = 3, BC = 2.5, C = 2, D = 1 e F = 0. Determinando a nota média de cada oferecimento pela ponderação da quantidade de alunos em cada extrato com os valores numéricos de cada conceito, indique (no que se referente a disciplinas no assunto de estatística):</p>
</section>
</section>
<section id="quem-é-o-professor-mais-difícil" class="level1">
<h1>Quem é o professor mais difícil?</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Professor mais difícil </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista os nomes dos professores com menor GPA médio</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>professor_dificil <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="st">"</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="st">WITH gpa_calculations AS (</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="st">    co.uuid AS course_offering_uuid,</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="st">    (CAST(gd.a_count AS INTEGER) * 4 + CAST(gd.ab_count AS INTEGER) * 3.5 + </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="st">     CAST(gd.b_count AS INTEGER) * 3 + CAST(gd.bc_count AS INTEGER) * 2.5 + </span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="st">     CAST(gd.c_count AS INTEGER) * 2 + CAST(gd.d_count AS INTEGER) * 1 + </span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="st">     CAST(gd.f_count AS INTEGER) * 0) / </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="st">    NULLIF((CAST(gd.a_count AS INTEGER) + CAST(gd.ab_count AS INTEGER) + </span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(gd.b_count AS INTEGER) + CAST(gd.bc_count AS INTEGER) + </span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(gd.c_count AS INTEGER) + CAST(gd.d_count AS INTEGER) + </span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(gd.f_count AS INTEGER)), 0) AS gpa</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM course_offerings co</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN grade_distributions gd ON co.uuid = gd.course_offering_uuid</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN subjects sub ON sm.subject_code = sub.code</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE sub.abbreviation = 'STAT'</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="st">    AND (CAST(gd.a_count AS INTEGER) + CAST(gd.ab_count AS INTEGER) + </span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(gd.b_count AS INTEGER) + CAST(gd.bc_count AS INTEGER) + </span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(gd.c_count AS INTEGER) + CAST(gd.d_count AS INTEGER) + </span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(gd.f_count AS INTEGER)) &gt; 0 ),</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="st">professor_gpas AS (</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT </span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="st">    i.id,</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="st">    i.name AS professor,</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG(gc.gpa) AS gpa_medio,</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(DISTINCT gc.course_offering_uuid) AS num_disciplinas</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM gpa_calculations gc</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN sections s ON gc.course_offering_uuid = s.course_offering_uuid</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN teachings t ON s.uuid = t.section_uuid</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN instructors i ON t.instructor_id = i.id</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE gc.gpa IS NOT NULL</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY i.id, i.name</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="st">  HAVING COUNT(DISTINCT gc.course_offering_uuid) &gt;= 1  ),</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="st">min_gpa AS (</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT MIN(gpa_medio) as min_gpa_medio</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM professor_gpas)</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="st">  pg.professor,</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(pg.gpa_medio, 4) AS gpa_medio,</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="st">  pg.num_disciplinas</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="st">FROM professor_gpas pg</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN min_gpa mg ON pg.gpa_medio = mg.min_gpa_medio</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY pg.professor;"</span>) </span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>professor_dificil</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       professor gpa_medio num_disciplinas
1 JAMES D KUELBS    2.5987               1</code></pre>
</div>
</div>
</section>
<section id="quem-é-o-professor-mais-fácil" class="level1">
<h1>Quem é o professor mais fácil?</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Professor mais facil </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista os nomes dos professores com maior GPA médio</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>professor_facil <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="st">"</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="st">WITH gpa_calculations AS (</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="st">    co.uuid AS course_offering_uuid,</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="st">    (CAST(gd.a_count AS INTEGER) * 4 + CAST(gd.ab_count AS INTEGER) * 3.5 + </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="st">     CAST(gd.b_count AS INTEGER) * 3 + CAST(gd.bc_count AS INTEGER) * 2.5 + </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="st">     CAST(gd.c_count AS INTEGER) * 2 + CAST(gd.d_count AS INTEGER) * 1 + </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="st">     CAST(gd.f_count AS INTEGER) * 0) / </span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="st">    NULLIF((CAST(gd.a_count AS INTEGER) + CAST(gd.ab_count AS INTEGER) + </span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(gd.b_count AS INTEGER) + CAST(gd.bc_count AS INTEGER) + </span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(gd.c_count AS INTEGER) + CAST(gd.d_count AS INTEGER) + </span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(gd.f_count AS INTEGER)), 0) AS gpa</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM course_offerings co</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN grade_distributions gd ON co.uuid = gd.course_offering_uuid</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN subjects sub ON sm.subject_code = sub.code</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE sub.abbreviation = 'STAT'</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="st">    AND (CAST(gd.a_count AS INTEGER) + CAST(gd.ab_count AS INTEGER) + </span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(gd.b_count AS INTEGER) + CAST(gd.bc_count AS INTEGER) + </span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(gd.c_count AS INTEGER) + CAST(gd.d_count AS INTEGER) + </span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(gd.f_count AS INTEGER)) &gt; 0 ),</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="st">professor_gpas AS (</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT </span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="st">    i.id,</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="st">    i.name AS professor,</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG(gc.gpa) AS gpa_medio,</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(DISTINCT gc.course_offering_uuid) AS num_disciplinas</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM gpa_calculations gc</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN sections s ON gc.course_offering_uuid = s.course_offering_uuid</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN teachings t ON s.uuid = t.section_uuid</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN instructors i ON t.instructor_id = i.id</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE gc.gpa IS NOT NULL</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY i.id, i.name</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="st">  HAVING COUNT(DISTINCT gc.course_offering_uuid) &gt;= 1 ),</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="st">max_gpa AS (</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT MAX(gpa_medio) as max_gpa_medio</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM professor_gpas )</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="st">  pg.professor,</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(pg.gpa_medio, 4) AS gpa_medio,</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a><span class="st">  pg.num_disciplinas</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="st">FROM professor_gpas pg</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN max_gpa mg ON pg.gpa_medio = mg.max_gpa_medio</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY pg.professor;"</span>) </span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>professor_facil</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     professor gpa_medio num_disciplinas
1                 GUANHUA CHEN         4               1
2 SRIKANTHMADHAVAN ARAVAMUTHAN         4               1
3                    YAJUAN SI         4               1</code></pre>
</div>
</div>
</section>
<section id="qual-é-a-disciplina-mais-difícil" class="level1">
<h1>Qual é a disciplina mais difícil?</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Disciplina mais difícil </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Lista o nome das disciplinas com menor GPA médio (seleciona valor min)</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>disciplina_dificil <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="st">"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="st">WITH gpa_calculations AS (</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="st">    co.uuid AS course_offering_uuid,</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="st">    co.course_uuid AS course_uuid,</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="st">    (CAST(gd.a_count AS INTEGER) * 4 + CAST(gd.ab_count AS INTEGER) * 3.5 + </span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="st">     CAST(gd.b_count AS INTEGER) * 3 + CAST(gd.bc_count AS INTEGER) * 2.5 + </span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="st">     CAST(gd.c_count AS INTEGER) * 2 + CAST(gd.d_count AS INTEGER) * 1 + </span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="st">     CAST(gd.f_count AS INTEGER) * 0) / </span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="st">    NULLIF((CAST(gd.a_count AS INTEGER) + CAST(gd.ab_count AS INTEGER) + </span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(gd.b_count AS INTEGER) + CAST(gd.bc_count AS INTEGER) + </span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(gd.c_count AS INTEGER) + CAST(gd.d_count AS INTEGER) + </span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(gd.f_count AS INTEGER)), 0) AS gpa</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM course_offerings co</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN grade_distributions gd ON co.uuid = gd.course_offering_uuid</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN subjects sub ON sm.subject_code = sub.code</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE sub.abbreviation = 'STAT'</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="st">    AND (CAST(gd.a_count AS INTEGER) + CAST(gd.ab_count AS INTEGER) + </span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(gd.b_count AS INTEGER) + CAST(gd.bc_count AS INTEGER) + </span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(gd.c_count AS INTEGER) + CAST(gd.d_count AS INTEGER) + </span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(gd.f_count AS INTEGER)) &gt; 0  ),</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="st">course_gpas AS (</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT </span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="st">    c.number AS course_number,</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="st">    c.name AS course_name,</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG(gc.gpa) AS gpa_medio,</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(DISTINCT gc.course_offering_uuid) AS num_ofertas</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM gpa_calculations gc</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN courses c ON gc.course_uuid = c.uuid</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE gc.gpa IS NOT NULL</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY c.number, c.name</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="st">  HAVING COUNT(DISTINCT gc.course_offering_uuid) &gt;= 1  ),</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="st">min_gpa AS (</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT MIN(gpa_medio) as min_gpa_medio</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM course_gpas )</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="st">  cg.course_number,</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="st">  cg.course_name,</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(cg.gpa_medio, 4) AS gpa_medio,</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="st">  cg.num_ofertas</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="st">FROM course_gpas cg</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN min_gpa mg ON cg.gpa_medio = mg.min_gpa_medio;"</span>)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>disciplina_dificil</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  course_number                               course_name gpa_medio num_ofertas
1           431 Introduction to the Theory of Probability    2.8916          22</code></pre>
</div>
</div>
</section>
<section id="qual-é-a-disciplina-mais-fácil" class="level1">
<h1>Qual é a disciplina mais fácil?</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Disciplina mais facil </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Lista o nome das disciplinas com maior GPA médio (seleciona valor max)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>disciplina_facil <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="st">"</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">WITH gpa_calculations AS (</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="st">    co.uuid AS course_offering_uuid,</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="st">    co.course_uuid AS course_uuid,</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="st">    -- Cálculo do GPA ponderado (convertendo TEXT para INT)</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="st">    (CAST(gd.a_count AS INTEGER) * 4 + CAST(gd.ab_count AS INTEGER) * 3.5 + </span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="st">     CAST(gd.b_count AS INTEGER) * 3 + CAST(gd.bc_count AS INTEGER) * 2.5 + </span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="st">     CAST(gd.c_count AS INTEGER) * 2 + CAST(gd.d_count AS INTEGER) * 1 + </span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="st">     CAST(gd.f_count AS INTEGER) * 0) / </span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="st">    NULLIF((CAST(gd.a_count AS INTEGER) + CAST(gd.ab_count AS INTEGER) + </span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(gd.b_count AS INTEGER) + CAST(gd.bc_count AS INTEGER) + </span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(gd.c_count AS INTEGER) + CAST(gd.d_count AS INTEGER) + </span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="st">            CAST(gd.f_count AS INTEGER)), 0) AS gpa</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM course_offerings co</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN grade_distributions gd ON co.uuid = gd.course_offering_uuid</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN subject_memberships sm ON co.uuid = sm.course_offering_uuid</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN subjects sub ON sm.subject_code = sub.code</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE sub.abbreviation = 'STAT'</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="st">    AND (CAST(gd.a_count AS INTEGER) + CAST(gd.ab_count AS INTEGER) + </span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(gd.b_count AS INTEGER) + CAST(gd.bc_count AS INTEGER) + </span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(gd.c_count AS INTEGER) + CAST(gd.d_count AS INTEGER) + </span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="st">         CAST(gd.f_count AS INTEGER)) &gt; 0 ),</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="st">course_gpas AS (</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT </span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="st">    c.number AS course_number,</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="st">    c.name AS course_name,</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG(gc.gpa) AS gpa_medio,</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(DISTINCT gc.course_offering_uuid) AS num_ofertas</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM gpa_calculations gc</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="st">  JOIN courses c ON gc.course_uuid = c.uuid</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE gc.gpa IS NOT NULL</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY c.number, c.name</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="st">  HAVING COUNT(DISTINCT gc.course_offering_uuid) &gt;= 1  ),</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="st">max_gpa AS (</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT MAX(gpa_medio) as max_gpa_medio</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM course_gpas )</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="st">  cg.course_number,</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="st">  cg.course_name,</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(cg.gpa_medio, 4) AS gpa_medio,</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="st">  cg.num_ofertas</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a><span class="st">FROM course_gpas cg</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN max_gpa mg ON cg.gpa_medio = mg.max_gpa_medio;"</span>)</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>disciplina_facil</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  course_number                                           course_name gpa_medio
1           628                                Data Science Practicum         4
2           811                       Sample Survey Theory and Method         4
3           834                        Empir Proc&amp;Semiparmtrc Infernc         4
4           841 Nonparametric Statistics and Machine Learning Methods         4
  num_ofertas
1           1
2           4
3           1
4           1</code></pre>
</div>
</div>
<section id="item-4" class="level2">
<h2 class="anchored" data-anchor-id="item-4">ITEM 4:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Desconectando da conexão conn</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(conn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvando a data e o horário em que o html foi gerado</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-09-23 12:20:46 -03"</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>